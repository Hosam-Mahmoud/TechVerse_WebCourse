<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Exam Simulator - Web Fundamentals</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
        }
        
        /* Start Screen */
        #startScreen {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            padding: 20px;
        }
        
        .start-container {
            max-width: 800px;
            width: 100%;
            padding: 40px 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin: 20px;
        }
        
        .start-icon {
            font-size: 5rem;
            margin-bottom: 30px;
            color: white;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        /* Exam Screen */
        #examScreen, #resultScreen {
            display: none;
            min-height: 100vh;
            padding: 20px 0 40px;
        }
        
        .exam-container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin: 0 auto;
        }
        
        .exam-header {
            background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 25px 20px;
            border-bottom: 1px solid #ddd;
        }
        
        .question-card {
            padding: 25px 20px;
            border-bottom: 1px solid #eee;
            transition: all 0.3s;
        }
        
        .question-card.active {
            background-color: #f9f9f9;
        }
        
        .question-number {
            display: inline-block;
            background-color: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            margin-right: 15px;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .question-type {
            display: inline-block;
            background-color: #e3f2fd;
            color: var(--primary-color);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .question-text {
            font-size: 1.2rem;
            font-weight: 500;
            margin: 20px 0;
            color: #333;
            line-height: 1.5;
        }
        
        .options-container {
            margin: 20px 0;
        }
        
        .option {
            padding: 16px 18px;
            margin-bottom: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }
        
        .option:hover {
            border-color: var(--primary-color);
            background-color: #f5f9ff;
            transform: translateX(5px);
        }
        
        .option.selected {
            border-color: var(--primary-color);
            background-color: #e3f2fd;
        }
        
        .option.correct-answer {
            border-color: var(--success-color);
            background-color: #d4edda;
            animation: correctAnswer 0.8s ease-out;
        }
        
        @keyframes correctAnswer {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .option.incorrect-answer {
            border-color: var(--danger-color);
            background-color: #f8d7da;
            animation: incorrectAnswer 0.5s ease;
        }
        
        @keyframes incorrectAnswer {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .option-label {
            display: inline-block;
            width: 40px;
            height: 40px;
            background-color: #e9ecef;
            border-radius: 50%;
            text-align: center;
            line-height: 40px;
            margin-right: 18px;
            font-weight: bold;
            font-size: 1rem;
            flex-shrink: 0;
            transition: all 0.3s;
        }
        
        .option.selected .option-label {
            background-color: var(--primary-color);
            color: white;
        }
        
        .option.correct-answer .option-label {
            background-color: var(--success-color);
            color: white;
        }
        
        .option.incorrect-answer .option-label {
            background-color: var(--danger-color);
            color: white;
        }
        
        .option-text {
            font-size: 1.05rem;
            flex-grow: 1;
            line-height: 1.5;
        }
        
        /* Feedback Container */
        .feedback-container {
            margin-top: 25px;
            padding: 20px;
            border-radius: 10px;
            background-color: #f8f9fa;
            border-left: 5px solid var(--warning-color);
            display: none;
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .feedback-header {
            display: flex;
            align-items: center;
            margin-bottom: 18px;
        }
        
        .feedback-icon {
            font-size: 1.8rem;
            margin-right: 15px;
        }
        
        .feedback-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        .motivational-message {
            font-size: 1.1rem;
            padding: 14px;
            border-radius: 8px;
            margin-bottom: 18px;
            font-weight: 500;
            text-align: center;
        }
        
        .motivational-message.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .motivational-message.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .language-tabs {
            display: flex;
            border-bottom: 1px solid #dee2e6;
            margin-bottom: 18px;
            overflow-x: auto;
            white-space: nowrap;
        }
        
        .language-tab {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            background: none;
            font-weight: 500;
            color: #6c757d;
            font-size: 1rem;
            flex: 1;
            text-align: center;
            min-width: 120px;
        }
        
        .language-tab.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
        }
        
        .explanation-section {
            margin-bottom: 20px;
        }
        
        .explanation-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid #eaeaea;
            display: flex;
            align-items: center;
        }
        
        .explanation-title i {
            margin-right: 10px;
        }
        
        /* تنسيق النصوص ثنائية اللغة */
        .language-separator {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .arabic-text {
            text-align: right;
            direction: rtl;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            font-size: 1.05rem;
            padding: 10px;
            border-right: 3px solid var(--primary-color);
            margin-bottom: 10px;
        }

        .english-text {
            text-align: left;
            direction: ltr;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            font-size: 1.05rem;
            padding: 10px;
            border-left: 3px solid var(--primary-color);
        }

        /* تنسيق نصيحة التحسين ثنائية اللغة */
        .improvement-section {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            margin-top: 20px;
            overflow: hidden;
        }

        .improvement-title {
            background-color: #f39c12;
            color: white;
            padding: 12px 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
        }

        .improvement-title i {
            margin-right: 10px;
        }

        .improvement-content {
            padding: 15px;
        }

        .improvement-arabic {
            text-align: right;
            direction: rtl;
            padding: 12px 15px;
            margin-bottom: 10px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 6px;
            border-right: 3px solid var(--warning-color);
            font-size: 1.05rem;
            line-height: 1.8;
        }

        .improvement-english {
            text-align: left;
            direction: ltr;
            padding: 12px 15px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 6px;
            border-left: 3px solid var(--warning-color);
            font-size: 1.05rem;
            line-height: 1.6;
        }
        
        .feedback-content {
            display: none;
        }
        
        .feedback-content.active {
            display: block;
        }
        
        /* Progress Sidebar */
        .progress-sidebar {
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            height: fit-content;
            position: sticky;
            top: 20px;
            margin-bottom: 30px;
        }
        
        .progress-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--secondary-color);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .progress-bar-container {
            margin-bottom: 20px;
        }
        
        .progress-text {
            text-align: center;
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: 500;
        }
        
        .section-progress {
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 0.95rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--secondary-color);
        }
        
        /* Navigation Buttons */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .btn-navigation {
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s;
            flex: 1;
            min-width: 140px;
            text-align: center;
        }
        
        .btn-navigation:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(0, 0, 0, 0.1);
        }
        
        /* Result Screen */
        #resultScreen {
            background-color: #f8f9fa;
        }
        
        .result-container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            animation: fadeIn 0.8s ease-out;
        }
        
        .result-header {
            background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
        }
        
        .result-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 15px;
        }
        
        .result-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            line-height: 1.5;
        }
        
        .score-display {
            text-align: center;
            padding: 40px 20px;
            position: relative;
        }
        
        .score-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            margin: 0 auto 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            background: conic-gradient(var(--success-color) 0% var(--percentage), #eee var(--percentage) 100%);
            position: relative;
            animation: pulse 2s infinite;
        }
        
        .score-circle-inner {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.2rem;
            color: var(--dark-color);
            flex-direction: column;
        }
        
        .score-percentage {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1;
        }
        
        .score-label {
            font-size: 1.1rem;
            color: #666;
            margin-top: 5px;
        }
        
        .result-stats {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px 0;
            padding: 0 20px;
        }
        
        .stat-box {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            min-width: 160px;
            transition: all 0.3s;
            flex: 1;
        }
        
        .stat-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .stat-box.correct {
            background-color: #d4edda;
            color: #155724;
        }
        
        .stat-box.incorrect {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .stat-box.score {
            background-color: #e3f2fd;
            color: var(--primary-color);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .result-details {
            padding: 40px 20px;
        }
        
        .details-title {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--secondary-color);
            margin-bottom: 30px;
            text-align: center;
        }
        
        .strength-section, .weakness-section {
            margin-bottom: 30px;
            padding: 25px 20px;
            border-radius: 15px;
        }
        
        .strength-section {
            background-color: #f0f9ff;
            border-left: 5px solid var(--primary-color);
        }
        
        .weakness-section {
            background-color: #fff5f5;
            border-left: 5px solid var(--danger-color);
        }
        
        .section-heading {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .strength-section .section-heading {
            color: var(--primary-color);
        }
        
        .weakness-section .section-heading {
            color: var(--danger-color);
        }
        
        .section-heading i {
            margin-right: 15px;
            font-size: 1.6rem;
        }
        
        .skill-list {
            list-style-type: none;
            padding-left: 0;
            margin: 0;
        }
        
        .skill-item {
            padding: 14px 18px;
            margin-bottom: 12px;
            background-color: white;
            border-radius: 10px;
            font-size: 1.05rem;
            display: flex;
            align-items: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }
        
        .skill-item:hover {
            transform: translateX(10px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .skill-item i {
            margin-right: 15px;
            font-size: 1.2rem;
        }
        
        .strength-section .skill-item i {
            color: var(--success-color);
        }
        
        .weakness-section .skill-item i {
            color: var(--warning-color);
        }
        
        .result-footer {
            padding: 30px 20px;
            background-color: #f8f9fa;
            border-top: 1px solid #eee;
            text-align: center;
        }
        
        .btn-action {
            padding: 14px 35px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 1.1rem;
            margin: 10px;
            transition: all 0.3s;
            display: inline-block;
            width: 100%;
            max-width: 250px;
        }
        
        .btn-action:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        /* Celebration animation for correct answers */
        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
            display: none;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 20px;
            background-color: #f00;
            top: -20px;
        }
        
        /* Mobile-specific styles */
        @media (max-width: 768px) {
            .start-icon {
                font-size: 4rem;
            }
            
            .start-container h1 {
                font-size: 2.2rem;
            }
            
            .start-container h3 {
                font-size: 1.4rem;
            }
            
            .question-card {
                padding: 20px 15px;
            }
            
            .question-number {
                width: 36px;
                height: 36px;
                line-height: 36px;
                font-size: 1rem;
            }
            
            .question-text {
                font-size: 1.1rem;
            }
            
            .option {
                padding: 14px 16px;
            }
            
            .option-label {
                width: 36px;
                height: 36px;
                line-height: 36px;
                margin-right: 15px;
            }
            
            .feedback-container {
                padding: 18px 16px;
            }
            
            .language-tab {
                padding: 10px 15px;
                min-width: 110px;
                font-size: 0.95rem;
            }
            
            .progress-sidebar {
                padding: 18px;
                position: static;
            }
            
            .btn-navigation {
                padding: 10px 20px;
                font-size: 0.95rem;
                min-width: 120px;
            }
            
            .result-header {
                padding: 30px 20px;
            }
            
            .result-title {
                font-size: 1.8rem;
            }
            
            .score-circle {
                width: 150px;
                height: 150px;
            }
            
            .score-circle-inner {
                width: 120px;
                height: 120px;
            }
            
            .score-percentage {
                font-size: 2rem;
            }
            
            .stat-box {
                min-width: 140px;
                padding: 18px;
            }
            
            .stat-value {
                font-size: 2rem;
            }
            
            .btn-action {
                padding: 12px 25px;
                font-size: 1rem;
                margin: 8px 5px;
                width: 90%;
            }
        }
        
        @media (max-width: 576px) {
            .start-icon {
                font-size: 3.5rem;
            }
            
            .start-container h1 {
                font-size: 1.8rem;
            }
            
            .exam-header h1 {
                font-size: 1.5rem;
            }
            
            .exam-header p {
                font-size: 0.95rem;
            }
            
            .question-number {
                width: 32px;
                height: 32px;
                line-height: 32px;
                font-size: 0.9rem;
                margin-right: 10px;
            }
            
            .question-type {
                padding: 4px 12px;
                font-size: 0.8rem;
            }
            
            .option {
                padding: 12px 14px;
            }
            
            .option-label {
                width: 32px;
                height: 32px;
                line-height: 32px;
                font-size: 0.9rem;
                margin-right: 12px;
            }
            
            .option-text {
                font-size: 1rem;
            }
            
            .navigation-buttons {
                flex-direction: column;
            }
            
            .btn-navigation {
                width: 100%;
                margin-bottom: 10px;
            }
            
            .stat-box {
                min-width: 100%;
                margin-bottom: 15px;
            }
            
            .result-stats {
                flex-direction: column;
            }
            
            .btn-action {
                width: 100%;
                margin: 8px 0;
            }
        }
        
        @media (max-width: 400px) {
            .start-container {
                padding: 30px 15px;
            }
            
            .question-card {
                padding: 18px 12px;
            }
            
            .question-text {
                font-size: 1.05rem;
            }
            
            .option-text {
                font-size: 0.95rem;
            }
            
            .language-tab {
                padding: 8px 10px;
                min-width: 90px;
                font-size: 0.9rem;
            }
            
            .score-circle {
                width: 130px;
                height: 130px;
            }
            
            .score-circle-inner {
                width: 100px;
                height: 100px;
            }
            
            .score-percentage {
                font-size: 1.8rem;
            }
        }
        
        /* Extra small devices */
        @media (max-width: 350px) {
            .start-icon {
                font-size: 3rem;
            }
            
            .start-container h1 {
                font-size: 1.6rem;
            }
            
            .question-number {
                width: 30px;
                height: 30px;
                line-height: 30px;
                font-size: 0.85rem;
            }
            
            .option-label {
                width: 30px;
                height: 30px;
                line-height: 30px;
                font-size: 0.85rem;
            }
        }
        
        /* Ensure proper spacing on all devices */
        .container, .container-fluid {
            padding-left: 15px;
            padding-right: 15px;
        }
        
        /* Improve touch targets on mobile */
        @media (hover: none) and (pointer: coarse) {
            .option, .btn-navigation, .btn-action, .language-tab {
                min-height: 44px;
            }
            
            .option {
                padding-top: 18px;
                padding-bottom: 18px;
            }
        }
        
        /* دعم الوضع الداكن */
        @media (prefers-color-scheme: dark) {
            .exam-container, .progress-sidebar, .result-container,
            .question-card, .feedback-container, .improvement-tip,
            .skill-item, .stat-box {
                background-color: #2c3e50;
                color: #ecf0f1;
            }
            
            .question-card {
                border-bottom-color: #34495e;
            }
            
            .question-text, .option-text, .explanation-text,
            .progress-title, .section-title, .stat-label,
            .skill-item, .details-title {
                color: #ecf0f1;
            }
            
            .option {
                border-color: #34495e;
                background-color: #34495e;
            }
            
            .option:hover {
                background-color: #3d566e;
            }
            
            .option-label {
                background-color: #4a6579;
                color: #ecf0f1;
            }
            
            .feedback-container {
                background-color: #34495e;
            }
            
            .language-tab {
                color: #bdc3c7;
            }
            
            .language-tab.active {
                color: #3498db;
            }
            
            /* دعم الوضع الداكن للأنماط الجديدة */
            .improvement-section {
                background-color: #3d2c00;
                border-color: #5a4a1a;
            }
            
            .improvement-title {
                background-color: #8b6914;
            }
            
            .improvement-arabic, .improvement-english {
                background-color: rgba(50, 50, 50, 0.7);
                color: #ecf0f1;
            }
            
            .arabic-text, .english-text {
                color: #ecf0f1;
            }
        }
    </style>
</head>
<body>
    <!-- Start Screen -->
    <div id="startScreen">
        <div class="start-container">
            <div class="start-icon">
                <i class="fas fa-graduation-cap"></i>
            </div>
            <h1 class="display-4 fw-bold mb-4">Exam Simulator</h1>
            <h3 class="mb-4">Web Fundamentals - HTML, CSS & Search Engines</h3>
            <button id="startExam" class="btn btn-light btn-lg px-5 py-3 fw-bold fs-4">
                Start Exam <i class="fas fa-play ms-3"></i>
            </button>

        </div>
    </div>

    <!-- Exam Screen -->
    <div id="examScreen">
        <div class="container-fluid">
            <div class="row">
                <!-- Exam Content -->
                <div class="col-lg-9 col-md-8 mb-4">
                    <div class="exam-container">
                        <div class="exam-header">
                            <h1 class="mb-2">Web Fundamentals Assessment Test</h1>
                            <p class="mb-0">Test for HTML, CSS & Search Engines</p>
                        </div>
                        
                        <div id="questionsContainer">
                            <!-- Questions will be dynamically inserted here -->
                        </div>
                        
                        <div class="navigation-buttons px-3 pb-3">
                            <button id="prevQuestion" class="btn btn-outline-secondary btn-navigation">
                                <i class="fas fa-arrow-left me-2"></i> Previous
                            </button>
                            <button id="nextQuestion" class="btn btn-primary btn-navigation">
                                Next <i class="fas fa-arrow-right ms-2"></i>
                            </button>
                            <button id="submitExam" class="btn btn-success btn-navigation" disabled>
                                <i class="fas fa-paper-plane me-2"></i> Submit Exam
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Progress Sidebar -->
                <div class="col-lg-3 col-md-4">
                    <div class="progress-sidebar">
                        <h3 class="progress-title">Exam Progress</h3>
                        
                        <div class="progress-bar-container">
                            <div class="progress" style="height: 20px;">
                                <div id="progressBar" class="progress-bar progress-bar-striped bg-success" role="progressbar" style="width: 0%"></div>
                            </div>
                            <div class="progress-text">
                                <span id="currentQuestionNum">1</span> of <span id="totalQuestions">40</span> questions
                            </div>
                        </div>
                        
                        <div class="section-progress">
                            <h5 class="section-title">Multiple Choice Questions</h5>
                            <div class="progress mb-3" style="height: 10px;">
                                <div id="sectionAProgress" class="progress-bar bg-primary" role="progressbar" style="width: 0%"></div>
                            </div>
                            
                            <h5 class="section-title">True / False Questions</h5>
                            <div class="progress mb-3" style="height: 10px;">
                                <div id="sectionBProgress" class="progress-bar bg-info" role="progressbar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="mt-4">
                            <h5 class="section-title">Your Performance</h5>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Correct Answers:</span>
                                <span id="correctCountDisplay" class="fw-bold text-success">0</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Incorrect Answers:</span>
                                <span id="incorrectCountDisplay" class="fw-bold text-danger">0</span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Current Score:</span>
                                <span id="currentScoreDisplay" class="fw-bold text-primary">0%</span>
                            </div>
                        </div>
                        
                        <div class="mt-5 text-center">
                            <button id="restartBtn" class="btn btn-outline-warning btn-sm">
                                <i class="fas fa-redo me-2"></i> Restart Exam
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Result Screen -->
    <div id="resultScreen">
        <div class="container py-4">
            <div class="result-container">
                <div class="result-header">
                    <h1 class="result-title">Exam Results</h1>
                    <p class="result-subtitle">Performance analysis for Web Fundamentals</p>
                </div>
                
                <div class="score-display">
                    <div class="score-circle" id="scoreCircle">
                        <div class="score-circle-inner">
                            <div class="score-percentage" id="finalScore">0</div>
                            <div class="score-label">SCORE</div>
                        </div>
                    </div>
                    
                    <h2 id="resultTitle" class="mb-3">Calculating your results...</h2>
                    <p id="resultDescription" class="lead">Based on your answers in the exam</p>
                </div>
                
                <div class="result-stats">
                    <div class="stat-box correct">
                        <div class="stat-value" id="correctCountResult">0</div>
                        <div class="stat-label">Correct Answers</div>
                    </div>
                    
                    <div class="stat-box incorrect">
                        <div class="stat-value" id="incorrectCountResult">0</div>
                        <div class="stat-label">Incorrect Answers</div>
                    </div>
                    
                    <div class="stat-box score">
                        <div class="stat-value" id="scorePercentageResult">0%</div>
                        <div class="stat-label">Final Score</div>
                    </div>
                </div>
                
                <div class="result-details">
                    <h2 class="details-title">Detailed Performance Analysis</h2>
                    
                    <div class="strength-section">
                        <h3 class="section-heading">
                            <i class="fas fa-check-circle"></i> Your Strengths
                        </h3>
                        <ul class="skill-list" id="strengthsList">
                            <!-- Strengths will be added by JavaScript -->
                        </ul>
                    </div>
                    
                    <div class="weakness-section">
                        <h3 class="section-heading">
                            <i class="fas fa-exclamation-triangle"></i> Areas for Improvement
                        </h3>
                        <ul class="skill-list" id="weaknessesList">
                            <!-- Weaknesses will be added by JavaScript -->
                        </ul>
                    </div>
                </div>
                
                <div class="result-footer">
                    <button id="restartExam" class="btn btn-primary btn-action">
                        <i class="fas fa-redo me-2"></i> Retake Exam
                    </button>
                    <button id="reviewAnswers" class="btn btn-outline-primary btn-action">
                        <i class="fas fa-eye me-2"></i> Review Answers
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Celebration Animation -->
    <div class="celebration" id="celebration"></div>

    <!-- Bootstrap & jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Helper functions
        function escapeHTMLTags(text) {
            if (!text) return '';
            return text.replace(/</g, '&lt;').replace(/>/g, '&gt;');
        }
        
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        // Exam data with all questions and bilingual explanations
        const examData = {
            title: "Final Exam - Web Fundamentals",
            sections: [
                {
                    title: "Section A: Multiple Choice Questions",
                    type: "mcq",
                    questions: [
                        {
                            id: 1,
                            question: "Which of the following is NOT part of the basic HTML document structure?",
                            options: [
                                "A) !DOCTYPE html",
                                "B) meta",
                                "C) html",
                                "D) body"
                            ],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "الوسم &lt;meta&gt; ليس جزءًا أساسيًا من هيكل مستند HTML. الهيكل الأساسي يتكون من &lt;!DOCTYPE html&gt; ثم &lt;html&gt; الذي يحتوي على &lt;head&gt; و&lt;body&gt;. الوسم &lt;meta&gt; اختياري داخل &lt;head&gt;.",
                                english: "The &lt;meta&gt; tag is not a fundamental part of HTML document structure. The basic structure consists of &lt;!DOCTYPE html&gt; followed by &lt;html&gt; containing &lt;head&gt; and &lt;body&gt;. The &lt;meta&gt; tag is optional within &lt;head&gt;."
                            },
                            improvement: {
                                arabic: "تذكر: هيكل HTML الأساسي: &lt;!DOCTYPE html&gt; → &lt;html&gt; → (&lt;head&gt; + &lt;body&gt;). الوسوم داخل &lt;head&gt; مثل &lt;meta&gt; و&lt;title&gt; و&lt;link&gt; اختيارية لكنها مفيدة.",
                                english: "Remember: Basic HTML structure: &lt;!DOCTYPE html&gt; → &lt;html&gt; → (&lt;head&gt; + &lt;body&gt;). Tags inside &lt;head&gt; like &lt;meta&gt;, &lt;title&gt;, &lt;link&gt; are optional but useful."
                            }
                        },
                        {
                            id: 2,
                            question: "The CSS property that allows an element to behave as relative until it reaches a scroll position, then behave as fixed is:",
                            options: [
                                "A) absolute",
                                "B) sticky",
                                "C) fixed",
                                "D) static"
                            ],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "position: sticky يجعل العنصر يتصرف كـ relative حتى يصل إلى موضع التمرير المحدد، ثم يصبح fixed. هذا مفيد للعناوين التي تبقى مرئية أثناء التمرير.",
                                english: "position: sticky makes an element behave as relative until it reaches a specified scroll position, then becomes fixed. This is useful for headers that stay visible while scrolling."
                            },
                            improvement: {
                                arabic: "استخدم sticky للعناوين أو القوائم التي تريد بقاءها مرئية. تحتاج إلى تحديد top أو bottom أو left أو right لتحديد موضع التثبيت.",
                                english: "Use sticky for headers or menus you want to stay visible. You need to specify top, bottom, left, or right to define the sticking position."
                            }
                        },
                        {
                            id: 3,
                            question: "Which attribute in &lt;form&gt; specifies how data is sent to the server?",
                            options: [
                                "A) action",
                                "B) method",
                                "C) target",
                                "D) enctype"
                            ],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "السمة method تحدد كيفية إرسال بيانات النموذج إلى الخادم (GET أو POST). GET يرسل البيانات في URL، بينما POST يرسلها في طلب HTTP.",
                                english: "The method attribute specifies how form data is sent to the server (GET or POST). GET sends data in the URL, while POST sends it in the HTTP request body."
                            },
                            improvement: {
                                arabic: "استخدم GET للطلبات الآمنة (مثل البحث)، وPOST لإرسال بيانات حساسة (مثل كلمات المرور). GET له حدود في حجم البيانات.",
                                english: "Use GET for safe requests (like search), POST for sensitive data (like passwords). GET has limits on data size."
                            }
                        },
                        {
                            id: 4,
                            question: "Which table attribute controls the number of columns a cell spans?",
                            options: [
                                "A) rowspan",
                                "B) cellspacing",
                                "C) colspan",
                                "D) border"
                            ],
                            correctAnswer: 2,
                            explanation: {
                                arabic: "السمة colspan تحدد عدد الأعمدة التي تمتد فيها خلية الجدول. مثلاً colspan='2' تجعل الخلية تمتد على عمودين. بينما rowspan للصفوف.",
                                english: "The colspan attribute specifies the number of columns a table cell spans. For example, colspan='2' makes the cell span two columns, while rowspan is for rows."
                            },
                            improvement: {
                                arabic: "تذكر: colspan للأعمدة، rowspan للصفوف. استخدمها لدمج الخلايا في الجداول. هذه السمات قديمة، والأفضل استخدام CSS للتصميم.",
                                english: "Remember: colspan for columns, rowspan for rows. Use them to merge table cells. These attributes are deprecated; CSS is better for styling."
                            }
                        },
                        {
                            id: 5,
                            question: "Which factor is LEAST related to search engine ranking?",
                            options: [
                                "A) Page relevance",
                                "B) Backlinks",
                                "C) Website color scheme",
                                "D) Page loading speed"
                            ],
                            correctAnswer: 2,
                            explanation: {
                                arabic: "مخطط الألوان في الموقع لا يؤثر على ترتيب محركات البحث بشكل مباشر. بينما محتوى الصفحة وارتباطاتها الداخلية وسرعة التحميل عوامل مهمة للـ SEO.",
                                english: "Website color scheme doesn't directly affect search engine ranking. Page content, backlinks, and loading speed are important SEO factors."
                            },
                            improvement: {
                                arabic: "ركز على: محتوى ذو جودة، سرعة التحميل، هيكل HTML سليم، روابط خلفية جودة. الألوان والتنسيق يؤثران على تجربة المستخدم فقط.",
                                english: "Focus on: quality content, loading speed, proper HTML structure, quality backlinks. Colors and styling affect user experience only."
                            }
                        },
                        {
                            id: 6,
                            question: "Which HTML element is used for long quotations?",
                            options: [
                                "A) &lt;q&gt;",
                                "B) &lt;pre&gt;",
                                "C) &lt;blockquote&gt;",
                                "D) &lt;code&gt;"
                            ],
                            correctAnswer: 2,
                            explanation: {
                                arabic: "&lt;blockquote&gt; يُستخدم للاقتباسات الطويلة (كتلة نصية). بينما &lt;q&gt; للاقتباسات القصيرة داخل النص. &lt;pre&gt; للنصوص مسبقة التنسيق، و&lt;code&gt; للكود البرمجي.",
                                english: "&lt;blockquote&gt; is used for long quotations (block-level). &lt;q&gt; is for short inline quotations. &lt;pre&gt; is for preformatted text, and &lt;code&gt; for code snippets."
                            },
                            improvement: {
                                arabic: "استخدم &lt;blockquote&gt; للاقتباسات الممتدة، و&lt;q&gt; للعبارات القصيرة داخل الجمل. يمكنك استخدام cite لتحديد مصدر الاقتباس.",
                                english: "Use &lt;blockquote&gt; for extended quotations, &lt;q&gt; for short phrases within sentences. You can use cite attribute to specify the source."
                            }
                        },
                        {
                            id: 7,
                            question: "What is the function of &lt;base href&gt; in a webpage?",
                            options: [
                                "A) Sets the homepage",
                                "B) Defines a base URL for all relative links",
                                "C) Improves SEO ranking",
                                "D) Controls hyperlink colors"
                            ],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "&lt;base href&gt; يحدد عنوان URL الأساسي لجميع الروابط النسبية في الصفحة. هذا يجعل الروابط النسبية تعتمد على هذا العنوان الأساسي بدلاً من عنوان الصفحة الحالي.",
                                english: "&lt;base href&gt; defines the base URL for all relative links on the page. This makes relative links resolve relative to this base URL instead of the current page URL."
                            },
                            improvement: {
                                arabic: "مفيد عندما يكون موقعك على نطاقات فرعية متعددة. ضع &lt;base&gt; داخل &lt;head&gt;. احذر: يؤثر على جميع الروابط النسبية في الصفحة.",
                                english: "Useful when your site is on multiple subdomains. Place &lt;base&gt; inside &lt;head&gt;. Be careful: it affects all relative links on the page."
                            }
                        },
                        {
                            id: 8,
                            question: "Which of the following elements is considered deprecated in modern HTML?",
                            options: [
                                "A) section",
                                "B) article",
                                "C) marquee",
                                "D) header"
                            ],
                            correctAnswer: 2,
                            explanation: {
                                arabic: "&lt;marquee&gt; قديم وغير مدعوم في HTML5. استبدل بتقنيات CSS وJavaScript للحركات. &lt;section&gt; و&lt;article&gt; و&lt;header&gt; عناصر دلالية حديثة في HTML5.",
                                english: "&lt;marquee&gt; is deprecated and not supported in HTML5. Replace with CSS and JavaScript animations. &lt;section&gt;, &lt;article&gt;, &lt;header&gt; are modern semantic elements in HTML5."
                            },
                            improvement: {
                                arabic: "تجنب العناصر القديمة: &lt;marquee&gt;, &lt;font&gt;, &lt;center&gt;, &lt;big&gt;. استخدم بدائل CSS وJavaScript. العناصر الدلالية الجديدة تحسن إمكانية الوصول والـ SEO.",
                                english: "Avoid deprecated elements: &lt;marquee&gt;, &lt;font&gt;, &lt;center&gt;, &lt;big&gt;. Use CSS and JavaScript alternatives. New semantic elements improve accessibility and SEO."
                            }
                        },
                        {
                            id: 9,
                            question: "Which HTML attribute provides additional semantic meaning and improves usability through tooltips?",
                            options: [
                                "A) lang",
                                "B) style",
                                "C) title",
                                "D) class"
                            ],
                            correctAnswer: 2,
                            explanation: {
                                arabic: "السمة title توفر معلومات إضافية تظهر كتلميح عند تمرير الماوس. تحسن إمكانية الاستخدام ولكنها لا تُقرأ تلقائيًا بواسطة قارئات الشاشة.",
                                english: "The title attribute provides additional information that appears as a tooltip on hover. It improves usability but isn't automatically read by screen readers."
                            },
                            improvement: {
                                arabic: "استخدم title لتوضيح العناصر، لكن لا تعتمد عليه لإمكانية الوصول. استخدم aria-label أو aria-describedby للوصولية الكاملة.",
                                english: "Use title to clarify elements, but don't rely on it for accessibility. Use aria-label or aria-describedby for full accessibility."
                            }
                        },
                        {
                            id: 10,
                            question: "Which CSS positioning type is relative to the browser viewport and does not move during scrolling?",
                            options: [
                                "A) absolute",
                                "B) relative",
                                "C) fixed",
                                "D) sticky"
                            ],
                            correctAnswer: 2,
                            explanation: {
                                arabic: "position: fixed يثبت العنصر بالنسبة لـ viewport ولا يتحرك مع التمرير. مثالي للقوائم الثابتة أو أزرار الدردشة.",
                                english: "position: fixed positions the element relative to the viewport and doesn't move during scrolling. Ideal for fixed menus or chat buttons."
                            },
                            improvement: {
                                arabic: "fixed مثالي للعناصر التي تبقى مرئية دائماً. احذر على الأجهزة المحمولة فقد يغطي محتوى مهم. استخدم media queries للتكيف.",
                                english: "fixed is ideal for always-visible elements. Be careful on mobile as it may cover important content. Use media queries for adaptation."
                            }
                        },
                        {
                            id: 11,
                            question: "Which of the following is NOT a responsibility of the Crawler?",
                            options: [
                                "A) Discovering new pages",
                                "B) Following hyperlinks",
                                "C) Ranking search results",
                                "D) Downloading page content"
                            ],
                            correctAnswer: 2,
                            explanation: {
                                arabic: "الزاحف (Crawler) لا يرتب نتائج البحث. وظيفته اكتشاف الصفحات واتباع الروابط وتنزيل المحتوى. ترتيب النتائج مهمة محرك التصنيف (Ranking Engine).",
                                english: "The Crawler doesn't rank search results. Its job is to discover pages, follow links, and download content. Ranking results is the job of the Ranking Engine."
                            },
                            improvement: {
                                arabic: "عملية البحث: 1) الزاحف يجمع الصفحات، 2) المفهرس يحلل ويخزن، 3) محرك التصنيف يرتب بناءً على الاستعلام. فهم الفروق بين المكونات مهم.",
                                english: "Search process: 1) Crawler collects pages, 2) Indexer analyzes and stores, 3) Ranking Engine sorts based on query. Understanding component differences is key."
                            }
                        },
                        {
                            id: 12,
                            question: "Which tag is used to define a definition list?",
                            options: [
                                "A) ul",
                                "B) ol",
                                "C) dl",
                                "D) list"
                            ],
                            correctAnswer: 2,
                            explanation: {
                                arabic: "&lt;dl&gt; يُستخدم لقوائم التعريفات. يحتوي على &lt;dt&gt; للمصطلح و&lt;dd&gt; للتعريف. بينما &lt;ul&gt; للقوائم غير المرتبة، و&lt;ol&gt; للقوائم المرتبة.",
                                english: "&lt;dl&gt; is used for definition lists. It contains &lt;dt&gt; for term and &lt;dd&gt; for definition. &lt;ul&gt; is for unordered lists, &lt;ol&gt; for ordered lists."
                            },
                            improvement: {
                                arabic: "مثال: &lt;dl&gt;&lt;dt&gt;HTML&lt;/dt&gt;&lt;dd&gt;لغة ترميز النصوص التشعبية&lt;/dd&gt;&lt;/dl&gt;. مفيد للقاموس أو قائمة المصطلحات. يحسن إمكانية الوصول والتنظيم.",
                                english: "Example: &lt;dl&gt;&lt;dt&gt;HTML&lt;/dt&gt;&lt;dd&gt;HyperText Markup Language&lt;/dd&gt;&lt;/dl&gt;. Useful for glossary or term lists. Improves accessibility and organization."
                            }
                        },
                        {
                            id: 13,
                            question: "What is the main function of the alt attribute?",
                            options: [
                                "A) Improve website speed",
                                "B) Improve accessibility and provide fallback text",
                                "C) Add animation to images",
                                "D) Control image size"
                            ],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "السمة alt تحسن إمكانية الوصول من خلال تقديم نص بديل للصور لقارئات الشاشة، وتوفر نصًا بديلًا عندما لا تحمل الصورة.",
                                english: "The alt attribute improves accessibility by providing alternative text for screen readers, and offers fallback text when images don't load."
                            },
                            improvement: {
                                arabic: "اكتب نص alt وصفياً: 'رجل يقرأ كتاب' بدلاً من 'صورة1'. للمصور التزيينية، استخدم alt='' فارغاً. لا تكرر النص المحيط.",
                                english: "Write descriptive alt text: 'man reading a book' instead of 'image1'. For decorative images, use alt=''. Don't repeat surrounding text."
                            }
                        },
                        {
                            id: 14,
                            question: "Which factor directly affects SEO performance?",
                            options: [
                                "A) Font family choice",
                                "B) Heading hierarchy (h1–h6)",
                                "C) Background color",
                                "D) Table border size"
                            ],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "تسلسل العناوين (h1–h6) يؤثر مباشرة على SEO. يوضح هيكل المحتوى ويساعد محركات البحث على فهم أولوية المعلومات في الصفحة.",
                                english: "Heading hierarchy (h1–h6) directly affects SEO. It clarifies content structure and helps search engines understand information priority on the page."
                            },
                            improvement: {
                                arabic: "استخدم هيكل عناوين منطقي: h1 واحد فقط للعنوان الرئيسي، ثم h2 للأقسام الرئيسية، h3 للفرعية. لا تقفز من h1 إلى h4.",
                                english: "Use logical heading structure: one h1 for main title, then h2 for main sections, h3 for subsections. Don't jump from h1 to h4."
                            }
                        },
                        {
                            id: 15,
                            question: "Which form control allows selecting multiple options?",
                            options: [
                                "A) radio button",
                                "B) checkbox",
                                "C) password field",
                                "D) submit button"
                            ],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "خانة الاختيار (checkbox) تتيح اختيار خيارات متعددة. بينما زر الراديو (radio button) يسمح باختيار خيار واحد فقط من المجموعة.",
                                english: "Checkbox allows selecting multiple options. Radio button allows selecting only one option from a group."
                            },
                            improvement: {
                                arabic: "استخدم checkbox للاختيارات المتعددة (مثل الهوايات)، وradio button للاختيار الواحد (مثل الجنس). مجموعة radio buttons يجب أن تشترك في نفس الاسم name.",
                                english: "Use checkbox for multiple selections (like hobbies), radio button for single selection (like gender). Radio buttons must share the same name attribute."
                            }
                        },
                        {
                            id: 16,
                            question: "Which CSS property is used together with position to control element placement?",
                            options: [
                                "A) margin",
                                "B) padding",
                                "C) top / left / right / bottom",
                                "D) display"
                            ],
                            correctAnswer: 2,
                            explanation: {
                                arabic: "الخصائص top، left، right، bottom تُستخدم مع position لتحديد موضع العنصر. مثلاً: position: absolute; top: 10px; left: 20px;.",
                                english: "The top, left, right, bottom properties are used with position to specify element placement. Example: position: absolute; top: 10px; left: 20px;."
                            },
                            improvement: {
                                arabic: "هذه الخصائص تعمل مع: relative وabsolute وfixed وsticky. لا تعمل مع static. القيم يمكن أن تكون بالسلبية لتحريك العنصر خارج حدوده.",
                                english: "These properties work with: relative, absolute, fixed, sticky. They don't work with static. Values can be negative to move element outside its boundaries."
                            }
                        },
                        {
                            id: 17,
                            question: "Which SEO practice improves both ranking and accessibility?",
                            options: [
                                "A) Inline styling",
                                "B) Semantic HTML",
                                "C) Large images",
                                "D) Marquee text"
                            ],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "HTML الدلالي يحسن كلاً من SEO وإمكانية الوصول. العناوين المنطقية والوسوم الدلالية تساعد محركات البحث وقارئات الشاشة على فهم المحتوى.",
                                english: "Semantic HTML improves both SEO and accessibility. Logical headings and semantic tags help search engines and screen readers understand content."
                            },
                            improvement: {
                                arabic: "استخدم الوسوم الدلالية: &lt;header&gt;, &lt;nav&gt;, &lt;main&gt;, &lt;article&gt;, &lt;section&gt;, &lt;aside&gt;, &lt;footer&gt;. تجنب &lt;div&gt; لكل شيء.",
                                english: "Use semantic tags: &lt;header&gt;, &lt;nav&gt;, &lt;main&gt;, &lt;article&gt;, &lt;section&gt;, &lt;aside&gt;, &lt;footer&gt;. Avoid using &lt;div&gt; for everything."
                            }
                        },
                        {
                            id: 18,
                            question: "Why does poor content hierarchy negatively affect SEO?",
                            options: [
                                "A) Increases server load",
                                "B) Confuses search engine understanding",
                                "C) Reduces CSS performance",
                                "D) Breaks JavaScript execution"
                            ],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "الهيكل الضعيف للمحتوى يربك محركات البحث في فهم أولوية المعلومات وعلاقتها. هذا يجعل من الصعب تحديد المحتوى الأكثر أهمية للاستعلامات.",
                                english: "Poor content hierarchy confuses search engines in understanding information priority and relationships. This makes it hard to determine most relevant content for queries."
                            },
                            improvement: {
                                arabic: "أنشئ هيكل محتوى واضح: عنوان رئيسي h1، عناوين فرعية h2، عناوين فرعية أصغر h3. استخدم القوائم والجداول لتنظيم البيانات المعقدة.",
                                english: "Create clear content structure: main h1 heading, subheadings h2, smaller subheadings h3. Use lists and tables to organize complex data."
                            }
                        },
                        {
                            id: 19,
                            question: "Which technology enables search engines to understand search intent?",
                            options: [
                                "A) Crawlers",
                                "B) DNS",
                                "C) NLP",
                                "D) Cache"
                            ],
                            correctAnswer: 2,
                            explanation: {
                                arabic: "معالجة اللغة الطبيعية (NLP) تمكن محركات البحث من فهم نية البحث من خلال تحليل الكلمات والعلاقات بينها. هذا يساعد في تقديم نتائج أكثر دقة.",
                                english: "Natural Language Processing (NLP) enables search engines to understand search intent by analyzing words and their relationships. This helps deliver more accurate results."
                            },
                            improvement: {
                                arabic: "NLP تطورت لتفهم: المرادفات، السياق، الأسئلة الكاملة. ككاتب محتوى، استخدم لغة طبيعية وأجب على الأسئلة المتوقعة في المحتوى.",
                                english: "NLP evolved to understand: synonyms, context, full questions. As a content writer, use natural language and answer expected questions in content."
                            }
                        },
                        {
                            id: 20,
                            question: "What is the main function of HTML?",
                            options: [
                                "A) Styling web pages",
                                "B) Structuring web content",
                                "C) Programming logic",
                                "D) Database management"
                            ],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "وظيفة HTML الرئيسية هي هيكلة محتوى الويب. تهتم بالعناصر والترابط بينها، بينما CSS مسؤولة عن التنسيق، وJavaScript عن التفاعل.",
                                english: "HTML's main function is structuring web content. It deals with elements and their relationships, while CSS handles styling, and JavaScript handles interactivity."
                            },
                            improvement: {
                                arabic: "تذكر: HTML للهيكل، CSS للتنسيق، JavaScript للسلوك. هذا الفصل يساعد في الصيانة والتحسين. استخدم كل لغة لمهمتها الأصلية.",
                                english: "Remember: HTML for structure, CSS for presentation, JavaScript for behavior. This separation helps maintenance and optimization. Use each language for its original purpose."
                            }
                        }
                    ]
                },
                {
                    title: "Section B: True / False Questions",
                    type: "truefalse",
                    questions: [
                        {
                            id: 21,
                            question: "&lt;br&gt; is an empty HTML element that does not require a closing tag.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. &lt;br&gt; عنصر فارغ (void element) لا يحتاج إلى وسم إغلاق. في HTML5 يمكن كتابته كـ &lt;br&gt; أو &lt;br /&gt;.",
                                english: "Correct. &lt;br&gt; is a void element that doesn't require a closing tag. In HTML5 it can be written as &lt;br&gt; or &lt;br /&gt;."
                            },
                            improvement: {
                                arabic: "العناصر الفارغة الأخرى: &lt;img&gt;, &lt;input&gt;, &lt;meta&gt;, &lt;link&gt;, &lt;hr&gt;. لا تحتوي على محتوى فلا تحتاج إغلاق.",
                                english: "Other void elements: &lt;img&gt;, &lt;input&gt;, &lt;meta&gt;, &lt;link&gt;, &lt;hr&gt;. They don't contain content so don't need closing."
                            }
                        },
                        {
                            id: 22,
                            question: "position: relative keeps the element in the normal flow but allows visual offset.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. position: relative يبقي العنصر في التدفق الطبيعي مع السماح بتحريكه بصرياً باستخدام top/left/right/bottom دون التأثير على العناصر الأخرى.",
                                english: "Correct. position: relative keeps the element in normal flow but allows visual offset using top/left/right/bottom without affecting other elements."
                            },
                            improvement: {
                                arabic: "مفيد لتحريك العناصر قليلاً من مكانها الأصلي. العناصر المجاورة تتصرف كما لو أن العنصر لم يتحرك من تدفق المستند.",
                                english: "Useful for slightly moving elements from their original position. Adjacent elements behave as if the element hasn't moved from document flow."
                            }
                        },
                        {
                            id: 23,
                            question: "The Indexing stage determines the order of results shown to users.",
                            options: ["True", "False"],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "خطأ. مرحلة الفهرسة (Indexing) تهتم بتحليل وتخزين المحتوى، أما ترتيب النتائج (Ranking) فهو مهمة محرك التصنيف بناءً على استعلام المستخدم.",
                                english: "Incorrect. The Indexing stage analyzes and stores content, while ordering results (Ranking) is the job of the Ranking Engine based on user query."
                            },
                            improvement: {
                                arabic: "عملية البحث: 1) الزحف 2) الفهرسة 3) التصنيف. الفهرسة تعد قاعدة البيانات، التصنيف يبحث ويُرتب حسب صلة النتائج بالاستعلام.",
                                english: "Search process: 1) Crawling 2) Indexing 3) Ranking. Indexing prepares the database, Ranking searches and sorts by relevance to query."
                            }
                        },
                        {
                            id: 24,
                            question: "&lt;alt&gt; text is used only when the image fails to load and has no role in accessibility.",
                            options: ["True", "False"],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "خطأ. نص alt له دور حاسم في إمكانية الوصول لقارئات الشاشة، وليس فقط كبديل عند فشل تحميل الصورة. هو يوفر وصفاً للصورة للمستخدمين ضعاف البصر.",
                                english: "Incorrect. Alt text has a crucial role in accessibility for screen readers, not just as fallback when images fail to load. It provides image description for visually impaired users."
                            },
                            improvement: {
                                arabic: "نص alt مطلوب للوصولية. قارئات الشاشة تقرأه لوصف الصور. للمصور التزيينية استخدم alt='' (فارغ). للصور المعلوماتية اكتب وصفاً دقيقاً.",
                                english: "Alt text is required for accessibility. Screen readers read it to describe images. For decorative images use alt='' (empty). For informative images write accurate description."
                            }
                        },
                        {
                            id: 25,
                            question: "&lt;th&gt; cells are centered and bold by default.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. خلايا رأس الجدول &lt;th&gt; تكون غامقة ومحاذاة للوسط افتراضياً في معظم المتصفحات. هذا يساعد في تمييزها عن خلايا البيانات &lt;td&gt;.",
                                english: "Correct. Table header cells &lt;th&gt; are bold and center-aligned by default in most browsers. This helps distinguish them from data cells &lt;td&gt;."
                            },
                            improvement: {
                                arabic: "يمكن تغيير التنسيق الافتراضي باستخدام CSS. لكن التنسيق الافتراضي يوفر تمييزاً مرئياً مفيداً. استخدم scope لتحديد إذا كان الرأس للعمود أو الصف.",
                                english: "You can change default styling with CSS. But default styling provides useful visual distinction. Use scope to specify if header is for column or row."
                            }
                        },
                        {
                            id: 26,
                            question: "Frames are replaced in modern design by CSS Grid and Flexbox.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. الإطارات (Frames) أصبحت قديمة واستبدلت بتقنيات CSS الحديثة مثل Grid وFlexbox. هذه التقنيات توفر مرونة وتحسين إمكانية الوصول والـ SEO.",
                                english: "Correct. Frames are deprecated and replaced by modern CSS techniques like Grid and Flexbox. These provide flexibility, better accessibility, and SEO."
                            },
                            improvement: {
                                arabic: "تجنب &lt;frameset&gt; و&lt;frame&gt;. استخدم CSS Grid للتصميمات المعقدة وFlexbox للمحاذاة والتوزيع. هذه التقنيات متجاوبة وتدعم الوصولية.",
                                english: "Avoid &lt;frameset&gt; and &lt;frame&gt;. Use CSS Grid for complex layouts and Flexbox for alignment and distribution. These techniques are responsive and accessibility-friendly."
                            }
                        },
                        {
                            id: 27,
                            question: "GET method sends form data visibly in the URL.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. طريقة GET ترسل بيانات النموذج كجزء من URL (بعد علامة ?). هذا يجعل البيانات مرئية ويمكن حفظها في سجل المتصفح.",
                                english: "Correct. GET method sends form data as part of the URL (after ?). This makes data visible and can be saved in browser history."
                            },
                            improvement: {
                                arabic: "استخدم GET للطلبات غير الحساسة (بحث، تصفية). تجنبه لكلمات المرور أو البيانات الشخصية. استخدم POST للبيانات الحساسة أو الكبيرة.",
                                english: "Use GET for non-sensitive requests (search, filter). Avoid for passwords or personal data. Use POST for sensitive or large data."
                            }
                        },
                        {
                            id: 28,
                            question: "&lt;pre&gt; preserves spaces and line breaks exactly as written in the HTML file.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. الوسم &lt;pre&gt; يحافظ على المسافات والفواصل الأسطر كما هي مكتوبة في ملف HTML. النص يظهر بخط ثابت العرض (monospace).",
                                english: "Correct. The &lt;pre&gt; tag preserves spaces and line breaks exactly as written in the HTML file. Text appears in monospace font."
                            },
                            improvement: {
                                arabic: "مفيد لعرض الكود البرمجي أو النص المنظم. استخدم مع &lt;code&gt; لعرض الكود. يمكنك استخدام CSS لتغيير الخط مع الحفاظ على التنسيق.",
                                english: "Useful for displaying code or formatted text. Use with &lt;code&gt; for code display. You can use CSS to change font while preserving formatting."
                            }
                        },
                        {
                            id: 29,
                            question: "position: absolute keeps space reserved for the element in the normal document flow.",
                            options: ["True", "False"],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "خطأ. position: absolute يزيل العنصر من التدفق الطبيعي للمستند، فلا يحتفظ بمساحة له. العناصر الأخرى تتصرف كما لو أن العنصر غير موجود.",
                                english: "Incorrect. position: absolute removes the element from normal document flow, so no space is reserved. Other elements behave as if the element doesn't exist."
                            },
                            improvement: {
                                arabic: "absolute يحتاج إلى سلف يتم تحديد موضعه (غير static). إذا لم يوجد، يستخدم body. استخدمه للعناصر العائمة أو القوائم المنسدلة.",
                                english: "absolute needs a positioned ancestor (not static). If none exists, it uses body. Use it for floating elements or dropdown menus."
                            }
                        },
                        {
                            id: 30,
                            question: "Search engines cannot index pages that are not discovered during crawling.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. محركات البحث لا تستطيع فهرسة صفحات لم تكتشفها أثناء الزحف. الصفحات المخفية خلف نماذج تسجيل الدخول أو بدون روابط تبقى خارج الفهرس.",
                                english: "Correct. Search engines cannot index pages not discovered during crawling. Pages hidden behind login forms or without links remain outside the index."
                            },
                            improvement: {
                                arabic: "لضمان فهرسة صفحتك: 1) تأكد من وجود روابط إليها 2) لا تحجبها في robots.txt 3) أرسل خريطة الموقع لـ Google Search Console.",
                                english: "To ensure page indexing: 1) Make sure there are links to it 2) Don't block it in robots.txt 3) Submit sitemap to Google Search Console."
                            }
                        },
                        {
                            id: 31,
                            question: "&lt;caption&gt; is used to provide a title for a table.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. &lt;caption&gt; يضيف عنواناً وصفياً للجدول. يظهر عادة فوق الجدول ويساعد في فهم محتواه، خاصة لقارئات الشاشة.",
                                english: "Correct. &lt;caption&gt; adds a descriptive title to a table. It usually appears above the table and helps understand its content, especially for screen readers."
                            },
                            improvement: {
                                arabic: "ضع &lt;caption&gt; مباشرة بعد فتح &lt;table&gt;. هذا يحسن إمكانية الوصول والتنظيم. استخدم &lt;thead&gt; و&lt;tbody&gt; و&lt;tfoot&gt; لتنظيم أفضل.",
                                english: "Place &lt;caption&gt; right after opening &lt;table&gt;. This improves accessibility and organization. Use &lt;thead&gt;, &lt;tbody&gt;, &lt;tfoot&gt; for better structure."
                            }
                        },
                        {
                            id: 32,
                            question: "HTML5 introduced semantic elements such as &lt;header&gt; and &lt;footer&gt;.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. HTML5 قدم عناصر دلالية مثل &lt;header&gt;, &lt;footer&gt;, &lt;nav&gt;, &lt;article&gt;, &lt;section&gt;, &lt;aside&gt;, &lt;main&gt;. هذه تحسن إمكانية الوصول والـ SEO.",
                                english: "Correct. HTML5 introduced semantic elements like &lt;header&gt;, &lt;footer&gt;, &lt;nav&gt;, &lt;article&gt;, &lt;section&gt;, &lt;aside&gt;, &lt;main&gt;. These improve accessibility and SEO."
                            },
                            improvement: {
                                arabic: "استخدم العناصر الدلالية بدلاً من &lt;div&gt; لكل شيء. هذا يساعد محركات البحث وقارئات الشاشة على فهم هيكل الصفحة ومحتواها.",
                                english: "Use semantic elements instead of &lt;div&gt; for everything. This helps search engines and screen readers understand page structure and content."
                            }
                        },
                        {
                            id: 33,
                            question: "The Deep Web represents illegal or dark web content only.",
                            options: ["True", "False"],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "خطأ. الويب العميق (Deep Web) يشمل جميع الصفحات غير المفهرسة، معظمها قانوني (مثل البريد الإلكتروني، الخدمات المصرفية عبر الإنترنت، قواعد البيانات). الويب المظلم (Dark Web) جزء صغير منه.",
                                english: "Incorrect. The Deep Web includes all unindexed pages, most of which are legal (like email, online banking, databases). The Dark Web is a small subset of it."
                            },
                            improvement: {
                                arabic: "الويب العميق: صفحات خلف نماذج أو تحتاج صلاحيات (97% من الويب). الويب المظلم: جزء مخفي يحتاج متصفحات خاصة (Tor). لا تخلط بينهما.",
                                english: "Deep Web: pages behind forms or requiring permissions (97% of web). Dark Web: hidden part needing special browsers (Tor). Don't confuse them."
                            }
                        },
                        {
                            id: 34,
                            question: "The Web can exist without the Internet.",
                            options: ["True", "False"],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "خطأ. الويب لا يمكن أن يوجد بدون الإنترنت. الإنترنت هو البنية التحتية العالمية للشبكات، بينما الويب هو خدمة تعمل على هذه البنية باستخدام بروتوكولات مثل HTTP.",
                                english: "Incorrect. The Web cannot exist without the Internet. The Internet is the global network infrastructure, while the Web is a service running on it using protocols like HTTP."
                            },
                            improvement: {
                                arabic: "الإنترنت: شبكات مترابطة عالمياً. الويب: نظام مستندات مرتبطة عبر الإنترنت. خدمات أخرى على الإنترنت: البريد الإلكتروني، FTP، التخاطب الفوري.",
                                english: "Internet: globally interconnected networks. Web: system of linked documents over Internet. Other Internet services: email, FTP, instant messaging."
                            }
                        },
                        {
                            id: 35,
                            question: "DNS converts IP addresses into domain names.",
                            options: ["True", "False"],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "خطأ. نظام اسم النطاق (DNS) يحول أسماء النطاق إلى عناوين IP، وليس العكس. عندما تكتب 'google.com'، يحولها DNS إلى عنوان IP مثل 142.250.185.78.",
                                english: "Incorrect. Domain Name System (DNS) converts domain names to IP addresses, not vice versa. When you type 'google.com', DNS converts it to an IP like 142.250.185.78."
                            },
                            improvement: {
                                arabic: "DNS هو دفتر عناوين الإنترنت. يحول الأسماء القابلة للقراءة البشرية (النطاقات) إلى أرقام IP التي تفهمها أجهزة الكمبيوتر. هذا يسهل تذكر المواقع.",
                                english: "DNS is Internet's phonebook. Converts human-readable names (domains) to IP numbers computers understand. This makes sites easier to remember."
                            }
                        },
                        {
                            id: 36,
                            question: "Static pages usually require server-side scripting.",
                            options: ["True", "False"],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "خطأ. الصفحات الثابتة (Static) لا تحتاج إلى معالجة من جانب الخادم. هي ملفات HTML جاهزة يتم إرسالها كما هي إلى المتصفح. الصفحات الديناميكية هي التي تحتاج معالجة.",
                                english: "Incorrect. Static pages don't require server-side processing. They're ready HTML files sent as-is to the browser. Dynamic pages need processing."
                            },
                            improvement: {
                                arabic: "الصفحات الثابتة: سريعة، آمنة، سهلة الاستضافة. الديناميكية: تتفاعل مع المستخدم، تحتاج خادم تطبيق (PHP، Python، Node.js).",
                                english: "Static pages: fast, secure, easy to host. Dynamic: interact with users, need application server (PHP, Python, Node.js)."
                            }
                        },
                        {
                            id: 37,
                            question: "Crawling always guarantees indexing.",
                            options: ["True", "False"],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "خطأ. الزحف لا يضمن الفهرسة دائماً. قد يتم الزحف إلى صفحة ولكن لا يتم فهرستها إذا كانت منخفضة الجودة أو مكررة أو محجوبة بالفهرسة.",
                                english: "Incorrect. Crawling doesn't always guarantee indexing. A page may be crawled but not indexed if low quality, duplicate, or blocked from indexing."
                            },
                            improvement: {
                                arabic: "لضمان الفهرسة بعد الزحف: 1) تحقق من noindex meta tag 2) تأكد من جودة المحتوى 3) تجنب المحتوى المكرر 4) استخدم canonical tags.",
                                english: "To ensure indexing after crawling: 1) Check noindex meta tag 2) Ensure content quality 3) Avoid duplicate content 4) Use canonical tags."
                            }
                        },
                        {
                            id: 38,
                            question: "Accessibility improves usability for all users, not only disabled users.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. إمكانية الوصول تحسن تجربة جميع المستخدمين، ليس فقط ذوي الإعاقات. مثال: النصوص الواضحة تساعد من هم على هواتف محمولة أو في بيئات مضاءة بشدة.",
                                english: "Correct. Accessibility improves experience for all users, not just disabled ones. Example: clear text helps those on mobile or in brightly lit environments."
                            },
                            improvement: {
                                arabic: "مبادئ إمكانية الوصل (WCAG): قابلية الإدراك، قابلية التشغيل، قابلية الفهم، المتانة. تطبيقها يحسن التجربة للجميع في جميع الظروف.",
                                english: "Web Content Accessibility Guidelines (WCAG): Perceivable, Operable, Understandable, Robust. Applying them improves experience for everyone in all conditions."
                            }
                        },
                        {
                            id: 39,
                            question: "HTTPS is a ranking factor in search engines.",
                            options: ["True", "False"],
                            correctAnswer: 0,
                            explanation: {
                                arabic: "صحيح. HTTPS أصبح عاملاً في ترتيب محركات البحث منذ 2014. المواقع الآمنة تحصل على دفعة طفيفة في الترتيب مقارنة بنظيراتها غير الآمنة HTTP.",
                                english: "Correct. HTTPS became a search ranking factor since 2014. Secure sites get a slight ranking boost compared to their HTTP counterparts."
                            },
                            improvement: {
                                arabic: "انتقل إلى HTTPS لـ: 1) تحسين SEO 2) حماية البيانات 3) ثقة المستخدمين 4) متطلبات المتصفحات الحديثة. استخدم شهادة SSL مجانية من Let's Encrypt.",
                                english: "Move to HTTPS for: 1) SEO boost 2) Data protection 3) User trust 4) Modern browser requirements. Use free SSL certificate from Let's Encrypt."
                            }
                        },
                        {
                            id: 40,
                            question: "Frames are considered modern and recommended in HTML5.",
                            options: ["True", "False"],
                            correctAnswer: 1,
                            explanation: {
                                arabic: "خطأ. الإطارات (Frames) تعتبر قديمة وغير موصى بها في HTML5. لها مشاكل في إمكانية الوصول والـ SEO والروابط المرجعية. استبدلت بـ CSS Grid وFlexbox.",
                                english: "Incorrect. Frames are considered obsolete and not recommended in HTML5. They have accessibility, SEO, and bookmarking issues. Replaced by CSS Grid and Flexbox."
                            },
                            improvement: {
                                arabic: "استخدم CSS Grid للتصميمات الشبكية المعقدة وFlexbox للمحاذاة والتوزيع المرن. هذه التقنيات متجاوبة وتدعم الوصولية بشكل أفضل من الإطارات.",
                                english: "Use CSS Grid for complex grid layouts and Flexbox for flexible alignment and distribution. These techniques are responsive and have better accessibility than frames."
                            }
                        }
                    ]
                }
            ]
        };

        // State management
        const examState = {
            currentQuestionIndex: 0,
            userAnswers: {},
            totalQuestions: 40,
            examStarted: false,
            correctCount: 0,
            incorrectCount: 0,
            shuffledQuestions: []
        };

        // DOM Elements
        const startScreen = document.getElementById('startScreen');
        const examScreen = document.getElementById('examScreen');
        const resultScreen = document.getElementById('resultScreen');
        const startExamBtn = document.getElementById('startExam');
        const submitExamBtn = document.getElementById('submitExam');
        const prevQuestionBtn = document.getElementById('prevQuestion');
        const nextQuestionBtn = document.getElementById('nextQuestion');
        const restartBtn = document.getElementById('restartBtn');
        const questionsContainer = document.getElementById('questionsContainer');
        const progressBar = document.getElementById('progressBar');
        const currentQuestionNum = document.getElementById('currentQuestionNum');
        const totalQuestionsEl = document.getElementById('totalQuestions');
        const correctCountDisplay = document.getElementById('correctCountDisplay');
        const incorrectCountDisplay = document.getElementById('incorrectCountDisplay');
        const currentScoreDisplay = document.getElementById('currentScoreDisplay');
        const sectionAProgress = document.getElementById('sectionAProgress');
        const sectionBProgress = document.getElementById('sectionBProgress');
        const restartExamBtn = document.getElementById('restartExam');
        const reviewAnswersBtn = document.getElementById('reviewAnswers');
        const celebration = document.getElementById('celebration');
        
        // Initialize exam
        function initializeExam() {
            examState.currentQuestionIndex = 0;
            examState.userAnswers = {};
            examState.examStarted = true;
            examState.correctCount = 0;
            examState.incorrectCount = 0;
            
            // Collect all questions and shuffle them
            let allQuestions = [];
            examData.sections.forEach(section => {
                section.questions.forEach(question => {
                    allQuestions.push({
                        ...question,
                        sectionType: section.type
                    });
                });
            });
            
            // Shuffle the questions
            examState.shuffledQuestions = shuffleArray(allQuestions);
            
            // Hide start screen, show exam screen
            startScreen.style.display = 'none';
            examScreen.style.display = 'block';
            resultScreen.style.display = 'none';
            
            // Render all questions
            renderAllQuestions();
            
            // Show first question
            showQuestion(0);
            
            // Update progress displays
            updateProgressBar();
            updateScoreDisplays();
            updateSectionProgress();
            
            // Set total questions
            totalQuestionsEl.textContent = examState.totalQuestions;
            
            // Reset submit button
            submitExamBtn.disabled = true;
            submitExamBtn.innerHTML = '<i class="fas fa-paper-plane me-2"></i> Submit Exam';
        }
        
        // Render all questions
        function renderAllQuestions() {
            questionsContainer.innerHTML = '';
            
            // Loop through shuffled questions
            examState.shuffledQuestions.forEach((question, index) => {
                const questionCard = document.createElement('div');
                questionCard.className = 'question-card';
                questionCard.id = `question-${index + 1}`;
                questionCard.dataset.questionId = question.id;
                questionCard.dataset.displayIndex = index + 1;
                
                let optionsHTML = '';
                if (question.sectionType === 'mcq') {
                    question.options.forEach((option, optionIndex) => {
                        optionsHTML += `
                            <div class="option" data-option-index="${optionIndex}">
                                <div class="option-label">${String.fromCharCode(65 + optionIndex)}</div>
                                <div class="option-text">${escapeHTMLTags(option)}</div>
                            </div>
                        `;
                    });
                } else if (question.sectionType === 'truefalse') {
                    optionsHTML = `
                        <div class="option" data-option-index="0">
                            <div class="option-label">T</div>
                            <div class="option-text">${escapeHTMLTags(question.options[0])}</div>
                        </div>
                        <div class="option" data-option-index="1">
                            <div class="option-label">F</div>
                            <div class="option-text">${escapeHTMLTags(question.options[1])}</div>
                        </div>
                    `;
                }
                
                questionCard.innerHTML = `
                    <div class="question-header">
                        <span class="question-number">${index + 1}</span>
                        <span class="question-type">${question.sectionType === 'mcq' ? 'Multiple Choice' : 'True/False'}</span>
                    </div>
                    <div class="question-text">${escapeHTMLTags(question.question)}</div>
                    <div class="options-container">
                        ${optionsHTML}
                    </div>
                    <div class="feedback-container" id="feedback-${question.id}">
                        <!-- Feedback will be added dynamically -->
                    </div>
                `;
                
                questionsContainer.appendChild(questionCard);
                
                // Add event listeners to options
                const options = questionCard.querySelectorAll('.option');
                options.forEach(option => {
                    option.addEventListener('click', function() {
                        handleAnswerSelection(question.id, parseInt(this.dataset.optionIndex));
                    });
                });
            });
        }
        
        // Show a specific question
        function showQuestion(index) {
            // Hide all questions
            const allQuestionCards = document.querySelectorAll('.question-card');
            allQuestionCards.forEach(card => {
                card.style.display = 'none';
                card.classList.remove('active');
            });
            
            // Show the selected question
            const selectedQuestionCard = document.getElementById(`question-${index + 1}`);
            if (selectedQuestionCard) {
                selectedQuestionCard.style.display = 'block';
                selectedQuestionCard.classList.add('active');
                examState.currentQuestionIndex = index;
                
                // Update current question number
                currentQuestionNum.textContent = index + 1;
                
                // Update navigation buttons
                updateNavigationButtons();
                
                // Update question card styling based on answer
                updateQuestionCardStyle(index + 1);
                
                // Scroll to the question
                selectedQuestionCard.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // Handle answer selection
        function handleAnswerSelection(questionId, selectedOptionIndex) {
            // If already answered, don't allow changing (for this demo)
            if (examState.userAnswers[questionId] !== undefined) return;
            
            // Store the answer
            examState.userAnswers[questionId] = selectedOptionIndex;
            
            // Find the question data
            const questionData = getQuestionData(questionId);
            
            // Check if answer is correct
            const isCorrect = selectedOptionIndex === questionData.correctAnswer;
            
            // Update counts
            if (isCorrect) {
                examState.correctCount++;
                showCelebration();
            } else {
                examState.incorrectCount++;
            }
            
            // Update the UI for this question
            updateQuestionCardStyleByQuestionId(questionId);
            
            // Show feedback for this question
            showFeedback(questionId, isCorrect);
            
            // Update progress bar
            updateProgressBar();
            
            // Update score displays
            updateScoreDisplays();
            
            // Update section progress
            updateSectionProgress();
            
            // Enable submit button if all questions answered
            const answeredCount = Object.keys(examState.userAnswers).length;
            if (answeredCount === examState.totalQuestions) {
                submitExamBtn.disabled = false;
                submitExamBtn.innerHTML = '<i class="fas fa-paper-plane me-2"></i> Show Results';
            }
        }
        
        // Get question data by ID
        function getQuestionData(questionId) {
            for (const section of examData.sections) {
                for (const question of section.questions) {
                    if (question.id === questionId) {
                        return question;
                    }
                }
            }
            return null;
        }
        
        // Update question card styling by display index
        function updateQuestionCardStyle(displayIndex) {
            const questionCard = document.getElementById(`question-${displayIndex}`);
            if (!questionCard) return;
            
            const questionId = parseInt(questionCard.dataset.questionId);
            updateQuestionCardStyleByQuestionId(questionId);
        }
        
        // Update question card styling by question ID
        function updateQuestionCardStyleByQuestionId(questionId) {
            // Find the question card by questionId
            const questionCards = document.querySelectorAll('.question-card');
            let targetCard = null;
            questionCards.forEach(card => {
                if (parseInt(card.dataset.questionId) === questionId) {
                    targetCard = card;
                }
            });
            
            if (!targetCard) return;
            
            // Remove all styling classes from options
            const options = targetCard.querySelectorAll('.option');
            options.forEach(option => {
                option.classList.remove('selected', 'correct-answer', 'incorrect-answer');
            });
            
            // Check if question is answered
            if (examState.userAnswers[questionId] !== undefined) {
                const questionData = getQuestionData(questionId);
                const isCorrect = examState.userAnswers[questionId] === questionData.correctAnswer;
                
                // Update option styling
                options.forEach(option => {
                    const optionIndex = parseInt(option.dataset.optionIndex);
                    
                    // Mark selected option
                    if (optionIndex === examState.userAnswers[questionId]) {
                        option.classList.add('selected');
                        
                        // Mark correct/incorrect
                        if (isCorrect) {
                            option.classList.add('correct-answer');
                        } else {
                            option.classList.add('incorrect-answer');
                        }
                    }
                    
                    // Mark correct answer (if different from selected)
                    if (optionIndex === questionData.correctAnswer && optionIndex !== examState.userAnswers[questionId]) {
                        option.classList.add('correct-answer');
                    }
                });
            }
        }
        
        // Show feedback for a question
        function showFeedback(questionId, isCorrect) {
            const questionData = getQuestionData(questionId);
            
            if (!questionData) return;
            
            // Find the feedback container
            const feedbackContainer = document.getElementById(`feedback-${questionId}`);
            if (!feedbackContainer) return;
            
            let motivationalMessage = '';
            
            if (isCorrect) {
                motivationalMessage = `<div class="motivational-message correct">
                    <i class="fas fa-trophy me-2"></i> Excellent! Correct answer! Keep focusing, you're on the right track.
                </div>`;
            } else {
                motivationalMessage = `<div class="motivational-message incorrect">
                    <i class="fas fa-lightbulb me-2"></i> Let's understand why this answer wasn't correct...
                </div>`;
            }
            
            feedbackContainer.innerHTML = `
                <div class="feedback-header">
                    <div class="feedback-icon">
                        <i class="fas ${isCorrect ? 'fa-check-circle text-success' : 'fa-times-circle text-danger'}"></i>
                    </div>
                    <div class="feedback-title">
                        ${isCorrect ? 'Correct Answer!' : 'Let\'s Review Together'}
                    </div>
                </div>
                
                ${motivationalMessage}
                
                <div class="language-tabs">
                    <button class="language-tab active" data-lang="arabic">العربية</button>
                    <button class="language-tab" data-lang="english">English</button>
                </div>
                
                <div class="feedback-content active" data-lang="arabic">
                    <div class="explanation-section">
                        <div class="explanation-title">
                            <i class="fas fa-info-circle"></i> الشرح
                        </div>
                        <div class="language-separator">
                            <div class="arabic-text">
                                ${questionData.explanation.arabic}
                            </div>
                        </div>
                    </div>
                    
                    ${questionData.improvement ? `
                    <div class="improvement-section">
                        <div class="improvement-title">
                            <i class="fas fa-graduation-cap"></i>معلومه 
                        </div>
                        <div class="improvement-content">
                            <div class="improvement-arabic">
                                ${questionData.improvement.arabic}
                            </div>
                        </div>
                    </div>
                    ` : ''}
                </div>
                
                <div class="feedback-content" data-lang="english">
                    <div class="explanation-section">
                        <div class="explanation-title">
                            <i class="fas fa-info-circle"></i> Explanation
                        </div>
                        <div class="language-separator">
                            <div class="english-text">
                                ${questionData.explanation.english}
                            </div>
                        </div>
                    </div>
                    
                    ${questionData.improvement ? `
                    <div class="improvement-section">
                        <div class="improvement-title">
                            <i class="fas fa-graduation-cap"></i> Improvement Tip
                        </div>
                        <div class="improvement-content">
                            <div class="improvement-english">
                                ${questionData.improvement.english}
                            </div>
                        </div>
                    </div>
                    ` : ''}
                </div>
            `;
            
            feedbackContainer.style.display = 'block';
            
            // إضافة مستمعي الأحداث لألسنة اللغة
            const languageTabs = feedbackContainer.querySelectorAll('.language-tab');
            languageTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const lang = this.dataset.lang;
                    
                    // تحديث اللسان النشط
                    languageTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // عرض المحتوى المقابل
                    const contents = feedbackContainer.querySelectorAll('.feedback-content');
                    contents.forEach(content => {
                        content.classList.remove('active');
                        if (content.dataset.lang === lang) {
                            content.classList.add('active');
                        }
                    });
                });
            });
            
            // التمرير إلى التغذية الراجعة
            setTimeout(() => {
                feedbackContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 300);
        }
        
        // Celebration animation for correct answers
        function showCelebration() {
            celebration.style.display = 'block';
            
            // Create confetti
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + 'vw';
                    confetti.style.backgroundColor = `hsl(${Math.random() * 360}, 100%, 50%)`;
                    confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                    celebration.appendChild(confetti);
                    
                    // Animate
                    const animation = confetti.animate([
                        { top: '-20px', transform: `rotate(0deg)` },
                        { top: '100vh', transform: `rotate(${Math.random() * 720}deg)` }
                    ], {
                        duration: 1000 + Math.random() * 2000,
                        easing: 'cubic-bezier(0.215, 0.61, 0.355, 1)'
                    });
                    
                    // Remove after animation
                    animation.onfinish = () => {
                        confetti.remove();
                    };
                }, i * 20);
            }
            
            // Hide celebration after 2 seconds
            setTimeout(() => {
                celebration.style.display = 'none';
                celebration.innerHTML = '';
            }, 2000);
        }
        
        // Update progress bar
        function updateProgressBar() {
            const answeredCount = Object.keys(examState.userAnswers).length;
            const progressPercentage = (answeredCount / examState.totalQuestions) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            progressBar.setAttribute('aria-valuenow', progressPercentage);
        }
        
        // Update score displays
        function updateScoreDisplays() {
            const answeredCount = Object.keys(examState.userAnswers).length;
            const currentScore = answeredCount > 0 ? Math.round((examState.correctCount / answeredCount) * 100) : 0;
            
            correctCountDisplay.textContent = examState.correctCount;
            incorrectCountDisplay.textContent = examState.incorrectCount;
            currentScoreDisplay.textContent = `${currentScore}%`;
        }
        
        // Update section progress
        function updateSectionProgress() {
            let sectionAAnswered = 0;
            let sectionBAnswered = 0;
            
            // Count answered questions by type
            examState.shuffledQuestions.forEach(question => {
                if (examState.userAnswers[question.id] !== undefined) {
                    if (question.sectionType === 'mcq') {
                        sectionAAnswered++;
                    } else if (question.sectionType === 'truefalse') {
                        sectionBAnswered++;
                    }
                }
            });
            
            const sectionAPercentage = (sectionAAnswered / 20) * 100;
            const sectionBPercentage = (sectionBAnswered / 20) * 100;
            
            sectionAProgress.style.width = `${sectionAPercentage}%`;
            sectionBProgress.style.width = `${sectionBPercentage}%`;
        }
        
        // Update navigation buttons
        function updateNavigationButtons() {
            // Previous button
            prevQuestionBtn.disabled = examState.currentQuestionIndex === 0;
            
            // Next button
            nextQuestionBtn.disabled = examState.currentQuestionIndex === examState.totalQuestions - 1;
        }
        
        // Calculate and show results
        function showResults() {
            // Calculate final score
            const scorePercentage = Math.round((examState.correctCount / examState.totalQuestions) * 100);
            
            // Update result screen
            document.getElementById('correctCountResult').textContent = examState.correctCount;
            document.getElementById('incorrectCountResult').textContent = examState.incorrectCount;
            document.getElementById('scorePercentageResult').textContent = `${scorePercentage}%`;
            document.getElementById('finalScore').textContent = scorePercentage;
            
            // Update score circle
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.style.setProperty('--percentage', `${scorePercentage}%`);
            
            // Set result title and description
            const resultTitle = document.getElementById('resultTitle');
            const resultDescription = document.getElementById('resultDescription');
            
            if (scorePercentage >= 90) {
                resultTitle.textContent = "Outstanding Performance!";
                resultTitle.style.color = "#27ae60";
                resultDescription.textContent = "You have exceptional understanding of web fundamentals. You're ready for advanced topics!";
            } else if (scorePercentage >= 75) {
                resultTitle.textContent = "Great Work!";
                resultTitle.style.color = "#3498db";
                resultDescription.textContent = "You have a strong understanding of web fundamentals with just a few points needing polishing.";
            } else if (scorePercentage >= 60) {
                resultTitle.textContent = "Good Effort!";
                resultTitle.style.color = "#f39c12";
                resultDescription.textContent = "You have a basic understanding but should review some key concepts before proceeding.";
            } else {
                resultTitle.textContent = "Keep Learning!";
                resultTitle.style.color = "#e74c3c";
                resultDescription.textContent = "You need to strengthen your understanding of web fundamentals. Review the basics and try again.";
            }
            
            // Generate strengths and weaknesses
            generateStrengthsAndWeaknesses();
            
            // Show result screen
            examScreen.style.display = 'none';
            resultScreen.style.display = 'block';
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Generate strengths and weaknesses based on answers
        function generateStrengthsAndWeaknesses() {
            const strengthsList = document.getElementById('strengthsList');
            const weaknessesList = document.getElementById('weaknessesList');
            
            strengthsList.innerHTML = '';
            weaknessesList.innerHTML = '';
            
            // Analyze performance by category
            const categories = {
                "HTML Basics": { correct: 0, total: 0 },
                "CSS Positioning": { correct: 0, total: 0 },
                "Forms & Tables": { correct: 0, total: 0 },
                "Search Engines & SEO": { correct: 0, total: 0 },
                "Web Concepts": { correct: 0, total: 0 },
                "Accessibility": { correct: 0, total: 0 }
            };
            
            // Categorize questions and check answers
            examState.shuffledQuestions.forEach(displayQuestion => {
                const question = getQuestionData(displayQuestion.id);
                if (!question) return;
                
                // Categorize question
                let category = "";
                
                // Categorize based on question content
                if ([1, 2, 6, 8, 9, 12, 14, 16, 20, 21, 25, 27, 28, 31, 32, 36].includes(question.id)) {
                    category = "HTML Basics";
                } else if ([2, 4, 10, 16, 18, 22, 29, 30].includes(question.id)) {
                    category = "CSS Positioning";
                } else if ([3, 4, 7, 15, 27].includes(question.id)) {
                    category = "Forms & Tables";
                } else if ([5, 11, 13, 17, 18, 19, 23, 30, 33, 37, 39].includes(question.id)) {
                    category = "Search Engines & SEO";
                } else if ([1, 5, 8, 10, 19, 24, 33, 34, 35, 38, 40].includes(question.id)) {
                    category = "Web Concepts";
                } else if ([3, 6, 9, 13, 17, 24, 25, 31, 32, 38].includes(question.id)) {
                    category = "Accessibility";
                }
                
                if (category && categories[category]) {
                    categories[category].total++;
                    
                    if (examState.userAnswers[question.id] === question.correctAnswer) {
                        categories[category].correct++;
                    }
                }
            });
            
            // Generate strengths and weaknesses
            const strengths = [];
            const weaknesses = [];
            
            for (const [category, performance] of Object.entries(categories)) {
                if (performance.total > 0) {
                    const accuracy = performance.correct / performance.total;
                    
                    if (accuracy >= 0.8) {
                        strengths.push(category);
                    } else if (accuracy <= 0.5) {
                        weaknesses.push(category);
                    }
                }
            }
            
            // Add strengths to list
            if (strengths.length > 0) {
                strengths.forEach(category => {
                    const li = document.createElement('li');
                    li.className = 'skill-item';
                    li.innerHTML = `<i class="fas fa-check-circle"></i> ${category}`;
                    strengthsList.appendChild(li);
                });
            } else {
                const li = document.createElement('li');
                li.className = 'skill-item';
                li.innerHTML = `<i class="fas fa-info-circle"></i> Focus on improving all areas`;
                strengthsList.appendChild(li);
            }
            
            // Add weaknesses to list
            if (weaknesses.length > 0) {
                weaknesses.forEach(category => {
                    const li = document.createElement('li');
                    li.className = 'skill-item';
                    li.innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${category}`;
                    weaknessesList.appendChild(li);
                });
            } else {
                const li = document.createElement('li');
                li.className = 'skill-item';
                li.innerHTML = `<i class="fas fa-check-circle"></i> Good performance across most areas`;
                weaknessesList.appendChild(li);
            }
        }
        
        // Event Listeners
        startExamBtn.addEventListener('click', initializeExam);
        
        submitExamBtn.addEventListener('click', function() {
            if (confirm("Are you sure you want to submit the exam and view the results?")) {
                showResults();
            }
        });
        
        prevQuestionBtn.addEventListener('click', function() {
            if (examState.currentQuestionIndex > 0) {
                showQuestion(examState.currentQuestionIndex - 1);
            }
        });
        
        nextQuestionBtn.addEventListener('click', function() {
            if (examState.currentQuestionIndex < examState.totalQuestions - 1) {
                showQuestion(examState.currentQuestionIndex + 1);
            }
        });
        
        restartBtn.addEventListener('click', function() {
            if (confirm("Are you sure you want to restart the exam? You will lose your current progress.")) {
                initializeExam();
            }
        });
        
        restartExamBtn.addEventListener('click', function() {
            if (confirm("Do you want to retake the exam?")) {
                initializeExam();
            }
        });
        
        reviewAnswersBtn.addEventListener('click', function() {
            // Go back to exam screen to review answers
            examScreen.style.display = 'block';
            resultScreen.style.display = 'none';
            
            // Show first question
            showQuestion(0);
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
        
        // Initialize with start screen
        window.addEventListener('DOMContentLoaded', function() {
            startScreen.style.display = 'flex';
            examScreen.style.display = 'none';
            resultScreen.style.display = 'none';
        });
    </script>
</body>
</html>

